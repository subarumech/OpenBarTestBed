{% extends "base.html" %}

{% block title %}Cocktail Recipes{% endblock %}

{% block content %}
<div class="page-wrapper">
    <div class="container">
        <h1>Recipes</h1>
        <div id="recipe-list"></div>
        <div style="text-align: center; margin-top: 20px;">
            <button onclick="window.location.href='{{ url_for('recipe_form') }}'" class="mode-button">Add New Recipe</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    let recipes = [];

    function loadRecipes() {
        fetch('/api/recipes')
            .then(response => response.json())
            .then(data => {
                recipes = data;
                displayRecipes();
            });
    }

    function deleteRecipe(recipeId) {
        fetch(`/api/recipes/${recipeId}`, {
            method: 'DELETE',
        })
        .then(() => {
            loadRecipes();
        });
    }

    function displayRecipes() {
        const recipeList = document.getElementById('recipe-list');
        recipeList.innerHTML = '';
        recipes.forEach(recipe => {
            const recipeElement = document.createElement('div');
            recipeElement.className = 'recipe-item';
            recipeElement.innerHTML = `
                <h3>${recipe.name}</h3>
                <p>${recipe.whiskey_type} - ${recipe.whiskey_volume} oz</p>
                <p>${recipe.syrup_type} - ${recipe.syrup_volume} oz</p>
                <p>${recipe.bitters_type} - ${recipe.bitters_volume} dashes</p>
                <div class="recipe-buttons">
                    <button onclick="window.location.href='{{ url_for('recipe_form') }}?id=${recipe.id}'" class="mode-button">Edit</button>
                    <button onclick="deleteRecipe(${recipe.id})" class="mode-button">Delete</button>
                </div>
            `;
            recipeList.appendChild(recipeElement);
        });
    }

    loadRecipes();
</script>
{% endblock %}